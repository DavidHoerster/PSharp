using System;

namespace PingPong
{
    [Main]
    machine Server
    {	
        Client Client;

        [Initial]
        state Init
        {
            entry
            {
                this.Client = create Client { this };
                raise Unit;
            }

            on Unit goto Playing;
        }

        state Playing
        {
            entry
            {
                send Pong to this.Client;
            }

            on Unit do SendPong;
            on Ping do SendPong;
            on Stop do StopIt;
        }

        action SendPong
        {
            send Pong to this.Client;
        }

        action StopIt
        {
            Console.WriteLine("Server stopped.\n");
            delete;
        }
    }
}
